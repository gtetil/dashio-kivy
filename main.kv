#:kivy 1.9.1

<ScreenManagement>:
    id: _sm
    ignition_input: app.arduino.ignition_input
    reverse_input: app.arduino.reverse_input
    Screen:
        name: 'off_screen'
    MainScreen:
        name: 'main_screen'
        sm: _sm
    CameraScreen:
        name: 'camera_screen'
        sm: _sm
    PasscodeScreen:
        name: 'passcode_screen'
        sm: _sm

<MainScreen>:
    id: main_screen

    TabbedPanel:
        id: main_tabbed_panel
        do_default_tab: False

        TabbedPanelItem:
            text: 'Home'
            id: home_tab

            BoxLayout:
                id: main_layout
                orientation: 'horizontal'
                padding: 10

                GridLayout:
                    id: di_layout
                    cols: 1
                    spacing: 5
                    padding: 5
                    size_hint_x: 0.25

                    DIIndicator:
                        text: 'Input 1'
                        index: 0
                    DIIndicator:
                        text: 'Input 2'
                        index: 1
                    DIIndicator:
                        text: 'Input 3'
                        index: 2
                    DIIndicator:
                        text: 'Input 4'
                        index: 3
                    DIIndicator:
                        text: 'Input 5'
                        index: 4
                    DIIndicator:
                        text: 'Input 6'
                        index: 5

                GridLayout:
                    id: do_layout
                    cols: 3
                    rows: 2
                    spacing: 5
                    padding: 5
                    size_hint_x: 0.75

                    DOToggle:
                        text: 'Output 1'
                        index: 0
                    DOToggle:
                        text: 'Output 2'
                        index: 1
                    DOToggle:
                        text: 'Output 3'
                        index: 2
                    DOToggle:
                        text: 'Output 4'
                        index: 3
                    DOToggle:
                        text: 'Output 5'
                        index: 4
                    DOToggle:
                        text: 'Output 6'
                        index: 5

        TabbedPanelItem:
            text: 'Settings'
            id: settings_tab

            RelativeLayout:
                id: settings_layout
                size_hint_x: None
                width: 124

                BoxLayout:
                    orientation: 'vertical'
                    padding: 10
                    spacing: 5

                    Label:
                        text: 'Screen\nBrightness'
                        markup: True
                        size_hint_y: 0.1
                        text_size: self.size
                        halign: 'center'
                        valign: 'middle'

                    Slider:
                        id: screen_light_slider
                        on_touch_move: app.brightness(self.value)
                        orientation: 'vertical'
                        min: 20
                        max: 200
                        value: 200
                        size_hint_y: 0.9

                Button:
                    id: exit_button
                    on_press: app.exit_app()
                    text: 'X'
                    size_hint: None, None
                    size: 20, 20
                    right: root.right

<PasscodeScreen>:
    id: passcode_screen
    fail_popup: fail_popup.__self__

    GridLayout:
        cols: 3
        rows: 4
        spacing: 5
        padding: 5
        size_hint_x: None
        width: 400
        pos: 200, 0

        Button:
            text: '7'
            on_release: root.sm.try_passcode(self.text)
        Button:
            text: '8'
            on_release: root.sm.try_passcode(self.text)
        Button:
            text: '9'
            on_release: root.sm.try_passcode(self.text)
        Button:
            text: '4'
            on_release: root.sm.try_passcode(self.text)
        Button:
            text: '5'
            on_release: root.sm.try_passcode(self.text)
        Button:
            text: '6'
            on_release: root.sm.try_passcode(self.text)
        Button:
            text: '1'
            on_release: root.sm.try_passcode(self.text)
        Button:
            text: '2'
            on_release: root.sm.try_passcode(self.text)
        Button:
            text: '3'
            on_release: root.sm.try_passcode(self.text)
        Button:
            text: '0'
            on_release: root.sm.try_passcode(self.text)

    Popup:
        id: fail_popup
        title: "Invalid Passcode"
        size_hint: None, None
        size: 150, 150
        on_parent: if self.parent == passcode_screen: self.parent.remove_widget(self)

        BoxLayout:
            orientation: 'vertical'
            padding: 5

            Button:
                text: 'Try Again'
                on_release: fail_popup.dismiss()

<CameraScreen>:
    id: camera_screen
    reverse_input: app.arduino.reverse_input




